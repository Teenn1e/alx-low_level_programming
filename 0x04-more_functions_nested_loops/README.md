More functions and nested loops qsns
